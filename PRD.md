# 제품 요구사항 문서 (PRD): TbotV9

## 1. 개요

TbotV9은 사용자가 자신만의 거래 전략을 쉽게 자동화할 수 있도록 지원하는 지능형 자동 거래 플랫폼입니다. 사용자는 복잡한 코딩 없이 직관적인 UI를 통해 거래 전략을 수립하고, 백테스팅을 통해 검증하며, 실제 시장에 적용할 수 있습니다.

## 2. 목표

- **사용자 편의성 극대화:** 전문 개발자가 아니더라도 누구나 쉽게 자신만의 거래 봇을 만들고 운영할 수 있도록 직관적인 UI/UX를 제공합니다.
- **높은 확장성:** '브로커 패턴'과 '플러그인 아키텍처'를 통해 다양한 거래소(브로커)와 사용자 정의 지표(인디케이터), 알림(노티파이어)을 쉽게 추가할 수 있는 구조를 만듭니다.
- **강력한 백테스팅:** 과거 데이터를 기반으로 전략의 수익성과 안정성을 검증할 수 있는 신뢰도 높은 백테스팅 기능을 제공합니다.
- **안정적인 실시간 거래:** FastAPI와 WebSocket을 기반으로 안정적이고 빠른 실시간 거래 환경을 구축합니다.

## 3. 핵심 기능

### 3.1. 전략 빌더 (Rule Builder)
- 사용자가 GUI 환경에서 '조건'과 '그룹'을 조합하여 복잡한 거래 전략을 시각적으로 구성할 수 있는 기능입니다.
- 각 조건(예: 'RSI가 30 미만')은 개별 시간 프레임(예: '5분봉', '1시간봉')을 가질 수 있습니다.

### 3.2. 다중 브로커 지원
- '브로커 패턴'을 적용하여 Upbit, Binance 등 여러 암호화폐 거래소를 지원합니다.
- 새로운 거래소를 추가할 때 핵심 로직의 변경을 최소화하는 것을 목표로 합니다.

### 3.3. 실시간 스캔 엔진
- 정의된 전략에 따라 실시간으로 시장 데이터를 스캔하고, 조건이 충족되면 알림을 보내거나 거래를 실행합니다.
- 2단계 스캔 방식을 사용합니다:
    1. **1차 스캔:** 현재 시세 데이터(Ticker)를 기반으로 시간 프레임이 없는 조건을 빠르게 필터링합니다.
    2. **2차 스캔:** 1차 스캔을 통과한 항목에 대해서만 OHLCV 데이터를 조회하여 시간 프레임이 있는 조건을 검사합니다.

### 3.4. 백테스팅
- 사용자가 생성한 전략을 과거 데이터에 적용하여 성과를 시뮬레이션하는 기능입니다.
- 수익률, MDD(최대 낙폭) 등 다양한 성과 지표를 제공합니다.

### 3.5. 알림 기능
- 이메일, 슬랙, 텔레그램 등 다양한 채널을 통해 거래 신호나 시스템 상태를 사용자에게 알립니다.
- '플러그인 아키텍처'를 통해 새로운 알림 채널을 쉽게 추가할 수 있습니다.

## 4. 기술 스택

- **백엔드:** FastAPI, Pydantic, SQLAlchemy, APScheduler
- **프론트엔드:** React, TypeScript, Vite, Mantine UI
- **데이터베이스:** SQLite (기본), PostgreSQL (프로덕션 권장)
- **테스팅:** Pytest (백엔드), React Testing Library, Playwright (프론트엔드)

## 5. 아키텍처 원칙

- **API 우선 계약 (API Contract-First):** OpenAPI 명세를 먼저 정의하고 백엔드와 프론트엔드 개발을 병렬로 진행합니다.
- **모듈식 설계:** 기능별로 독립적인 모듈로 개발하여 유지보수성과 재사용성을 높입니다.
- **격리 기반 테스팅:** 단위 테스트는 외부 서비스나 데이터베이스에 의존하지 않고 독립적으로 실행되어야 합니다.
- **CI/CD:** GitHub Actions를 통해 코드 스타일 검사, 테스트, 빌드, 배포를 자동화합니다.
